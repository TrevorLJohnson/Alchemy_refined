{"mappings":"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","sources":["main.js"],"sourcesContent":["// frontend/main.js\r\n\r\n// UI elements\r\nconst sendBtn           = document.getElementById('send-btn');\r\nconst chatInput         = document.getElementById('user-input');\r\nconst chatHistory       = document.getElementById('chat-history');\r\nconst categorySections  = document.getElementById('category-sections');\r\nconst pieCanvasCtx      = document.getElementById('pie-canvas').getContext('2d');\r\n\r\n// Roman numerals for label\r\nfunction toRoman(num) {\r\n  const romans = [\r\n    '', 'I','II','III','IV','V','VI','VII','VIII','IX','X',\r\n    'XI','XII','XIII','XIV','XV','XVI','XVII','XVIII','XIX','XX'\r\n  ];\r\n  return romans[num] || num;\r\n}\r\n\r\n// Color palette for pie slices\r\nconst COLORS = [\r\n  '#8884d8','#82ca9d','#ffc658','#0088FE','#FF8042',\r\n  '#FFBB28','#00C49F','#A28EF4','#F47CA2','#FF6633'\r\n];\r\n\r\n// Initialize empty pie chart\r\nconst pieChart = new Chart(pieCanvasCtx, {\r\n  type: 'pie',\r\n  data: {\r\n    labels: [],\r\n    datasets: [{\r\n      data: [],\r\n      backgroundColor: COLORS\r\n    }]\r\n  },\r\n  options: {\r\n    plugins: { legend: { position: 'bottom' } }\r\n  }\r\n});\r\n\r\n// In-memory history\r\nconst historyEntries = [];\r\n\r\n// Main send handler\r\nasync function sendPrompt() {\r\n  const text = chatInput.value.trim();\r\n  if (!text) return;\r\n\r\n  // 1) Render user bubble\r\n  const wrapper = document.createElement('div');\r\n  wrapper.style.display = 'flex';\r\n  wrapper.style.flexDirection = 'column';\r\n  wrapper.style.alignItems = 'flex-start';\r\n\r\n  const userDiv = document.createElement('div');\r\n  userDiv.textContent = text;\r\n  Object.assign(userDiv.style, {\r\n    alignSelf: 'flex-end',\r\n    background: '#6B46C1',\r\n    color: '#FFF',\r\n    padding: '0.5rem 1rem',\r\n    borderRadius: '1rem',\r\n    maxWidth: '60%',\r\n    margin: '0.25rem 0'\r\n  });\r\n  wrapper.appendChild(userDiv);\r\n\r\n  // 2) Call API\r\n  let json;\r\n  try {\r\n    const res = await fetch('http://localhost:5000/api/chat', {\r\n      method:  'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body:    JSON.stringify({ text })\r\n    });\r\n    json = await res.json();\r\n    if (!res.ok) {\r\n      alert('Server error: ' + json.error);\r\n      return;\r\n    }\r\n  } catch (err) {\r\n    alert('Network error: ' + err.message);\r\n    return;\r\n  }\r\n\r\n  // 3) Render assistant bubble\r\n  const replyDiv = document.createElement('div');\r\n  replyDiv.textContent = json.reply;\r\n  Object.assign(replyDiv.style, {\r\n    alignSelf: 'flex-start',\r\n    background: '#2D3748',\r\n    color: '#FFF',\r\n    padding: '0.5rem 1rem',\r\n    borderRadius: '1rem',\r\n    maxWidth: '60%',\r\n    margin: '0.25rem 0'\r\n  });\r\n  wrapper.appendChild(replyDiv);\r\n\r\n  chatHistory.appendChild(wrapper);\r\n\r\n  // 4) Normalize categories\r\n  const rawCats = Array.isArray(json.categories)\r\n    ? json.categories\r\n    : (json.categories?.current || []);\r\n  const cats = rawCats.map(c =>\r\n    typeof c === 'string' ? { name: c, value: 1 } : { name: c.name, value: c.value }\r\n  );\r\n\r\n  // 5) Record in history\r\n  historyEntries.unshift({\r\n    timestamp: json.timestamp,\r\n    cats,\r\n    wrapper\r\n  });\r\n\r\n  // 6) Re-render category sections\r\n  categorySections.innerHTML = '';\r\n  historyEntries.forEach((entry, idx) => {\r\n    const section = document.createElement('div');\r\n    section.style.cursor = 'pointer';\r\n    section.style.padding = '0.5rem 0';\r\n    section.style.borderTop = idx > 0 ? '1px solid #4A5568' : 'none';\r\n\r\n    const header = document.createElement('h3');\r\n    header.textContent = `${toRoman(idx+1)}. ${entry.timestamp}`;\r\n    header.style.color = '#9F7AEA';\r\n    header.style.margin = '0';\r\n    section.appendChild(header);\r\n\r\n    const ul = document.createElement('ul');\r\n    ul.style.listStyle = 'disc';\r\n    ul.style.paddingLeft = '1.5rem';\r\n    ul.style.color = '#E2E8F0';\r\n    entry.cats.forEach(cat => {\r\n      const li = document.createElement('li');\r\n      li.textContent = cat.name;\r\n      ul.appendChild(li);\r\n    });\r\n    section.appendChild(ul);\r\n\r\n    section.addEventListener('click', () => {\r\n      // Update pie to that entry\r\n      pieChart.data.labels = entry.cats.map(c => c.name);\r\n      pieChart.data.datasets[0].data = entry.cats.map(c => c.value);\r\n      pieChart.update();\r\n      // Scroll chat to that conversation\r\n      entry.wrapper.scrollIntoView({ behavior: 'smooth', block: 'start' });\r\n    });\r\n\r\n    categorySections.appendChild(section);\r\n  });\r\n\r\n  // 7) Update pie to current\r\n  pieChart.data.labels = cats.map(c => c.name);\r\n  pieChart.data.datasets[0].data = cats.map(c => c.value);\r\n  pieChart.update();\r\n\r\n  // 8) Clear input\r\n  chatInput.value = '';\r\n}\r\n\r\n// Wire interactions\r\nsendBtn.addEventListener('click', sendPrompt);\r\nchatInput.addEventListener('keydown', e => {\r\n  if (e.key === 'Enter') {\r\n    e.preventDefault();\r\n    sendPrompt();\r\n  }\r\n});\r\n"],"names":[],"version":3,"file":"frontend.c4775257.js.map","sourceRoot":"/__parcel_source_root/"}